      SUBROUTINE GETIN(W1,W2,WCOUNT)
* 
*  GET A COMMAND FROM THE ADVENTURER. 
* 
*  W1 IS SET TO THE FIRST WORD OF HIS COMMAND.  W2 IS SET TO THE
*  SECOND WORD.  WCOUNT HOLDS THE POINTER POSITION FOR THE LINE.
* 
      IMPLICIT INTEGER(A-Z) 
      LOGICAL BLKLIN,YESCALL
      Character*10 Blank, W1, W2, WORD
      Character*80 Line
      COMMON /IOSCOM/ BLKLIN,YESCALL
      DIMENSION T(22)
      DATA BLANK/' '/ 

      W1=' '
      W2=' '
      IF(BLKLIN)WRITE(6,1)
    1 FORMAT(1X)
      WRITES=WCOUNT 
      IF(YESCALL) WRITES=0
      IF(WCOUNT.NE.0) GOTO 20 
    5 READ(5,10,end=5) LINE
   10 FORMAT(80A)
      CALL STR$UPCASE(LINE,LINE)
   20 WCOUNT=WCOUNT+1 
      IF(WCOUNT.GT.80) GOTO 90
      IF(LINE(WCOUNT:WCOUNT).EQ.BLANK) GOTO 20 
      WORD=' '
      WSTART=WCOUNT 
   30 IF(LINE(WCOUNT:WCOUNT).EQ.' ') GOTO 100
      IF(WCOUNT.GT.80) GOTO 100 
      ptr = wcount-wstart+1
      IF(WCOUNT-WSTART.LE.10) WORD(ptr:ptr)=LINE(WCOUNT:WCOUNT) 
      WCOUNT=WCOUNT+1 
      GOTO 30 
   90 WCOUNT=0
      IF(W1.NE.' ') GOTO 200
      WRITES=0
      GOTO 5
  
  100 IF(WORD.EQ.' '.AND.W1.EQ.' ') GOTO 20 
      IF(WORD.EQ.' ') GOTO 200
      IF(WCOUNT-WSTART.GE.10) GOTO 120
      TEMP=WCOUNT-WSTART+1
      DO 110 LOOP=TEMP,10 
  110 WORD(loop:loop) = BLANK
  120 IF(W1.NE.' ') W2=WORD 
      IF(W2.EQ.' ') W1=WORD 
      IF(LINE(WCOUNT:WCOUNT).NE.BLANK) GOTO 200
      IF(W2.EQ.' ') GOTO 20 
      WCOUNT=WCOUNT+1 
  130 IF(WCOUNT.GT.80) GOTO 200 
      IF(LINE(WCOUNT:WCOUNT).EQ.BLANK) GOTO 140
  140 WCOUNT=WCOUNT+1 
      GOTO 130
  
  200 IF(WRITES.EQ.0) RETURN
      IF(BLKLIN) WRITE(6,1) 
      WRITE(6,220) WD1,WD2
  220 FORMAT(A10,x,A10) 
      RETURN
      END 
