C***   LOG

       SUBROUTINE LOG(SCORE,TURNS,NUMDIE)
       IMPLICIT INTEGER(A-Z)
$INSERT SYSCOM>A$KEYS
      DIMENSION DDD(8),TTT(4),VEC(15)
      LOGICAL ACTIVE
      INTEGER*4 MESSGS
      COMMON/LNKCOM/ACTIVE(32),USER(15,32),MESSGS(32),MONITO(32),
     1 TEXT(70,32)
      COMMON/WRUCOM/ME

      DIMENSION FILE(11),PART1(3),PART2(3)
      DATA FILE/'GRIPE       GAME.LOG  '/
       DATA PART1/:157763,:177755,:173777/,PART2/:166755,:163763,
     1 :165676/
       ERCNT=0
       CALL DATE$A(DDD)
       CALL TIME$A(TTT)
      CALL TIMDAT(VEC,15)
100   FILE(4)=AND(PART1(1),PART2(1))
      FILE(5)=AND(PART1(2),PART2(2))
      FILE(6)=AND(PART1(3),PART2(3))
      IF(.NOT.OPEN$A(A$WRIT,'ADVENTURE>GAME.LOG',18,10))GOTO 200
      CALL GEND$A(10)

       WRITE (14,102)(VEC(I),I=13,15),DDD,TTT,SCORE,TURNS,NUMDIE
102     FORMAT(/1X,3A2,' finished his tour at ',8A2,' ',4A2,
     2/8X,I3,' points; ',I4,' Turns;  ',I1,' Reincarnations.')
      CALL CLOS$A(10)
1001  ACTIVE(ME)=.FALSE.
      DO 1002 I=4,6
1002  FILE(I)=' '
      CALL BREAK$(.FALSE.)
       RETURN

200     ERCNT=ERCNT+1
       IF(ERCNT.GT.2)GOTO 1001
       PRINT 202,ERCNT
202     FORMAT(/' LOG FILE BLOCKED.  WAIT...(',I1,')')
      CALL SLEEP$(0002000)
       GOTO 100

       END
